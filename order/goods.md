# 明细

模型
---------------------------------------------------------------------------

### Schema
Column                              | Type      | Null | Note
------------------------------------|-----------|------|-------
`id`                                | int       | No   | 
`grinding_paste_via`                | int       | Yes  | 研磨膏制作途径 Lookup: 自制和外协
`need_coat`                         | bool      | Yes  | 是否需要镀覆
`need_pick`                         | bool      | Yes  | 是否需要取料

### 研磨膏制作途径
由于历史原因,订单中研磨膏取料没有单独新建二次加工单，而是通过系统自动转换取料微粉的方式实现。外协研磨膏出现后，会以采购的形式直接采购研磨膏成品，这就导致一个问题：这些采购的研磨膏无法以订单取料的方式出库，只能盘出去。

基于此，需要新增一个记录制作途径的布尔列：`grinding_paste_via` 来解决此问题。需要说明的是，如果自制研磨膏能强制通过二次加工的形式体现，这一列完全不需要。

新建订单时，如果商品是研磨膏，则自动将该列的值设置成“自制”。仓库后期根据实际情况更改途径；该列对取料的“应取数量” (`pickableQuantity`)也有影响：外协时不需要单位转换，订货数量即应取数量；自制的应取数量会根据浓度折算；

操作
---------------------------------------------------------------------------

### 无需取料

对于一些无法取料的特殊情况，管理员可通过 `goods/toggle-pickness` 将订货明细设置为无需取料，从而跳过取料环节。

Change Logs
--------------------------------------------------------------------------
- 2023-11-28 Enh `Schema` 新增 `need_coat` 布尔列，以订货明细为单位记录是否需要镀覆；
